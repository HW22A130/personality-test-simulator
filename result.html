<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>診断結果</title>

    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            background: #f9f9f9;
        }

        h1,
        h2 {
            text-align: center;
        }

        .result-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        /* スライダー */
        .slider-box {
            margin-top: 20px;
        }

        input[type="range"] {
            width: 100%;
        }

        /* 4象限マップ */
        .map {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .quadrant {
            position: relative;
            padding: 10px;
            height: 130px;
            border-radius: 6px;
            font-size: 14px;
        }

        .q1 {
            background: #e8f5e9;
        }

        .q2 {
            background: #fffde7;
        }

        .q3 {
            background: #fff3e0;
        }

        .q4 {
            background: #ffebee;
        }

        .dot {
            width: 14px;
            height: 14px;
            background: #d32f2f;
            border-radius: 50%;
            position: absolute;
            bottom: 10px;
            right: 10px;
        }

        .comment {
            margin-top: 20px;
            padding: 15px;
            background: #eef2f5;
            border-radius: 6px;
            font-size: 14px;
        }
    </style>
</head>

<body>

    <h1>診断結果</h1>

    <div class="result-box">
        <p id="scoreText"></p>

        <div class="slider-box">
            <label>
                趣味時間に占めるギャンブルの割合（％）
                <input type="range" min="0" max="100" value="20" id="timeRate">
            </label>
            <p>現在：<strong><span id="rateValue">20</span>%</strong></p>
        </div>
    </div>

    <h2>あなたの現在位置</h2>

    <div class="map">
        <div class="quadrant q2" id="q2">
            ② 依存度が高まりやすい<br>
            （自覚しにくい）
        </div>
        <div class="quadrant q4" id="q4">
            ④ 注意が必要<br>
            （依存・生活影響）
        </div>
        <div class="quadrant q1" id="q1">
            ① 適度な距離<br>
            （娯楽の範囲）
        </div>
        <div class="quadrant q3" id="q3">
            ③ 時間消費が大きい<br>
            （生活バランス注意）
        </div>
    </div>

    <div class="comment" id="commentBox">
        コメントが表示されます
    </div>

    <script>
        // ===============================
        // ▼ 判定基準（後で調整可能）
        // ===============================
        const DEPENDENCE_BORDER = 8;
        const TIME_BORDER = 30;

        // ===============================
        // ▼ 診断結果取得
        // ===============================
        const result = JSON.parse(localStorage.getItem("riskResult"));
        const scoreText = document.getElementById("scoreText");

        if (!result) {
            scoreText.textContent = "診断結果が見つかりません。";
        } else {
            scoreText.textContent = `依存度スコア：${result.riskScore}`;
        }

        // ===============================
        // ▼ スライダー
        // ===============================
        const slider = document.getElementById("timeRate");
        const rateValue = document.getElementById("rateValue");

        slider.oninput = () => {
            rateValue.textContent = slider.value;
            updateResult();
        };

        // ===============================
        // ▼ 4象限判定
        // ===============================
        function getQuadrant(risk, time) {
            if (risk < DEPENDENCE_BORDER && time < TIME_BORDER) return 1;
            if (risk >= DEPENDENCE_BORDER && time < TIME_BORDER) return 2;
            if (risk < DEPENDENCE_BORDER && time >= TIME_BORDER) return 3;
            return 4;
        }

        // ===============================
        // ▼ コメント文
        // ===============================
        const comments = {
            1: "現在はギャンブルと適切な距離を保てている状態です。今後も時間と金額の管理を意識しましょう。",
            2: "現時点では時間は抑えられていますが、依存リスクが高まりやすい状態です。頻度やきっかけを振り返ってみましょう。",
            3: "依存度は高くありませんが、使用時間が長くなりやすい傾向があります。生活全体のバランスを確認してみてください。",
            4: "依存度・使用時間ともに注意が必要な状態です。休む日を設ける、第三者に相談するなどの選択肢も考えてみましょう。"
        };

        // ===============================
        // ▼ 表示更新
        // ===============================
        function updateResult() {
            document.querySelectorAll(".dot").forEach(d => d.remove());

            const q = getQuadrant(result.riskScore, slider.value);
            const target = document.getElementById("q" + q);

            const dot = document.createElement("div");
            dot.className = "dot";
            target.appendChild(dot);

            document.getElementById("commentBox").textContent = comments[q];

            // 次ページ・管理者用に保存
            localStorage.setItem("quadrantResult", q);
            localStorage.setItem("timeRate", slider.value);
        }

        // 初期表示
        updateResult();
    </script>

</body>

</html>